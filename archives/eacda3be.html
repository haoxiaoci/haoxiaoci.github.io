<!-- build time:Thu Mar 19 2020 15:44:07 GMT+0800 (GMT+08:00) --><!DOCTYPE html><html class="theme-next mist use-motion" lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" content="#222"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4"><link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222"><meta name="keywords" content="pep8,python,"><link rel="alternate" href="/atom.xml" title="桃之夭夭" type="application/atom+xml"><meta name="description" content="python项目为了保持易读性，可维护性，做了代码格式规范，我大概总结了一下这些在格式化python代码中常用到的工具；pep8link：pep8官方网站：https://www.python.org/dev/peps/pep-0008/中文翻译版：https://alvinzhu.xyz/2017/10/07/python-pep-8/#toppycodestylelink：https://py"><meta name="keywords" content="pep8,python"><meta property="og:type" content="article"><meta property="og:title" content="python格式化整理"><meta property="og:url" content="https://haoxiaoci.github.io/archives/eacda3be.html"><meta property="og:site_name" content="桃之夭夭"><meta property="og:description" content="python项目为了保持易读性，可维护性，做了代码格式规范，我大概总结了一下这些在格式化python代码中常用到的工具；pep8link：pep8官方网站：https://www.python.org/dev/peps/pep-0008/中文翻译版：https://alvinzhu.xyz/2017/10/07/python-pep-8/#toppycodestylelink：https://py"><meta property="og:locale" content="zh-Hans"><meta property="og:image" content="https://upload-images.jianshu.io/upload_images/7770956-379138054a9979d9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"><meta property="og:image" content="https://upload-images.jianshu.io/upload_images/7770956-2c836aaddce3dfe5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"><meta property="og:image" content="https://upload-images.jianshu.io/upload_images/7770956-7615f92f05a28958.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"><meta property="og:updated_time" content="2018-12-20T08:34:36.177Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="python格式化整理"><meta name="twitter:description" content="python项目为了保持易读性，可维护性，做了代码格式规范，我大概总结了一下这些在格式化python代码中常用到的工具；pep8link：pep8官方网站：https://www.python.org/dev/peps/pep-0008/中文翻译版：https://alvinzhu.xyz/2017/10/07/python-pep-8/#toppycodestylelink：https://py"><meta name="twitter:image" content="https://upload-images.jianshu.io/upload_images/7770956-379138054a9979d9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Mist",version:"5.1.4",sidebar:{position:"left",display:"post",offset:12,b2t:!1,scrollpercent:!1,onmobile:!0},fancybox:!0,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="https://haoxiaoci.github.io/archives/eacda3be.html"><title>python格式化整理 | 桃之夭夭</title></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">桃之夭夭</span> <span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">自留地</h1></div><div class="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br>关于</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br>搜索</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i> </span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"><input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://haoxiaoci.github.io/archives/eacda3be.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="haoxiaoci"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.gif"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="桃之夭夭"></span><header class="post-header"><h2 class="post-title" itemprop="name headline">python格式化整理</h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-12-19T17:24:02+08:00">2018-12-19 </time></span><span class="post-comments-count"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-comment-o"></i> </span><a href="/archives/eacda3be.html#comments" itemprop="discussionUrl"><span class="post-comments-count gitment-comments-count" data-xid="/archives/eacda3be.html" itemprop="commentsCount"></span></a></span></div></header><div class="post-body" itemprop="articleBody"><p>python项目为了保持易读性，可维护性，做了代码格式规范，我大概总结了一下这些在格式化python代码中常用到的工具；</p><h2 id="pep8"><a href="#pep8" class="headerlink" title="pep8"></a>pep8</h2><p>link：</p><p>pep8官方网站：<a href="https://www.python.org/dev/peps/pep-0008/" target="_blank" rel="noopener">https://www.python.org/dev/peps/pep-0008/</a></p><p>中文翻译版：<a href="https://alvinzhu.xyz/2017/10/07/python-pep-8/#top" target="_blank" rel="noopener">https://alvinzhu.xyz/2017/10/07/python-pep-8/#top</a></p><h2 id="pycodestyle"><a href="#pycodestyle" class="headerlink" title="pycodestyle"></a>pycodestyle</h2><p>link：</p><p><a href="https://pycodestyle.readthedocs.io/en/latest/" target="_blank" rel="noopener">https://pycodestyle.readthedocs.io/en/latest/</a></p><p><a href="https://github.com/PyCQA/pycodestyle" target="_blank" rel="noopener">https://github.com/PyCQA/pycodestyle</a></p><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>pycodestyle is a tool to check your Python code against some of the style conventions in PEP 8.</p><p>pycodestyle是一个检查python代码是否匹配pep8风格的工具</p><h3 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h3><ul><li>Plugin architecture: Adding new checks is easy(插件结构，安装起来很方便)</li><li>Parseable output: Jump to error location in your editor.(输出易读，直接指出错误代码的位置)</li><li>Small: Just one Python file, requires only stdlib. You can use just the pycodestyle.py file for this purpose.(安装文件小，就一个python脚本，外加依赖一个库stdlib)</li><li>Comes with a comprehensive test suite.(代码检查很全面)</li></ul><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pip install pycodestyle</span><br><span class="line">pip install --upgrade pycodestyle # 安装或更新，下文中其他包的安装更新，亦是如此，不再重复</span><br><span class="line">pip uninstall pycodestyle   # 卸载包，下文中其他包的卸载，亦是如此，不再重复</span><br></pre></td></tr></table></figure><h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><p>举例：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ pycodestyle --first optparse.py</span><br><span class="line">optparse.py:69:11: E401 multiple imports on one line</span><br><span class="line">optparse.py:77:1: E302 expected 2 blank lines, found 1</span><br><span class="line">optparse.py:88:5: E301 expected 1 blank line, found 0</span><br><span class="line">optparse.py:222:34: W602 deprecated form of raising exception</span><br><span class="line">optparse.py:347:31: E211 whitespace before &apos;(&apos;</span><br><span class="line">optparse.py:357:17: E201 whitespace after &apos;&#123;&apos;</span><br><span class="line">optparse.py:472:29: E221 multiple spaces before operator</span><br><span class="line">optparse.py:544:21: W601 .has_key() is deprecated, use &apos;in&apos;</span><br></pre></td></tr></table></figure><p>使用pycodestyle检查pep8语法的错误：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ pycodestyle --show-source --show-pep8 testsuite/E40.py</span><br><span class="line">testsuite/E40.py:2:10: E401 multiple imports on one line</span><br><span class="line">import os, sys</span><br><span class="line">         ^</span><br><span class="line">    Imports should usually be on separate lines.</span><br><span class="line">    </span><br><span class="line">    Okay: import os\nimport sys</span><br><span class="line">    E401: import sys, os</span><br></pre></td></tr></table></figure><p>统计状态码出现的次数：<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ pycodestyle --statistics -qq Python-2.5/Lib</span><br><span class="line">232     E201 whitespace after &apos;[&apos;</span><br><span class="line">599     E202 whitespace before &apos;)&apos;</span><br><span class="line">631     E203 whitespace before &apos;,&apos;</span><br><span class="line">842     E211 whitespace before &apos;(&apos;</span><br><span class="line">2531    E221 multiple spaces before operator</span><br><span class="line">4473    E301 expected 1 blank line, found 0</span><br><span class="line">4006    E302 expected 2 blank lines, found 1</span><br><span class="line">165     E303 too many blank lines (4)</span><br><span class="line">325     E401 multiple imports on one line</span><br><span class="line">3615    E501 line too long (82 characters)</span><br><span class="line">612     W601 .has_key() is deprecated, use &apos;in&apos;</span><br><span class="line">1188    W602 deprecated form of raising exception</span><br></pre></td></tr></table></figure><p></p><p>官方的介绍更详细一点，实在是懒得翻译：<br><a href="https://pycodestyle.readthedocs.io/en/latest/intro.html" target="_blank" rel="noopener">https://pycodestyle.readthedocs.io/en/latest/intro.html</a></p><h2 id="flake8"><a href="#flake8" class="headerlink" title="flake8"></a>flake8</h2><p>link:</p><p><a href="http://flake8.pycqa.org/en/latest/" target="_blank" rel="noopener">http://flake8.pycqa.org/en/latest/</a></p><p><a href="https://pypi.org/project/flake8/" target="_blank" rel="noopener">https://pypi.org/project/flake8/</a></p><h3 id="简介-1"><a href="#简介-1" class="headerlink" title="简介"></a>简介</h3><p>Flake8 是由Python官方发布的一款辅助检测Python代码是否规范的工具，相对于目前热度比较高的Pylint来说，Flake8检查规则灵活，支持集成额外插件，扩展性强。Flake8是对下面三个工具的封装：</p><ol><li>PyFlakes：静态检查Python代码逻辑错误的工具。github:<a href="https://github.com/pycqa/pyflakes" target="_blank" rel="noopener">https://github.com/pycqa/pyflakes</a></li><li>Pep8： 静态检查PEP8编码风格的工具。</li><li>NedBatchelder’s McCabe ：静态分析Python代码复杂度的工具。github: <a href="https://github.com/pycqa/mccabe" target="_blank" rel="noopener">https://github.com/pycqa/mccabe</a><br>不光对以上三个工具的封装，Flake8还提供了扩展的开发接口。</li></ol><h3 id="安装-1"><a href="#安装-1" class="headerlink" title="安装"></a>安装</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install flake8</span><br></pre></td></tr></table></figure><p>官方的安装解释：<a href="http://flake8.pycqa.org/en/latest/index.html#installation-guide" target="_blank" rel="noopener">http://flake8.pycqa.org/en/latest/index.html#installation-guide</a></p><h3 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flake8 a.py</span><br></pre></td></tr></table></figure><p>一台机器上安装了多个版本的python时，指定python的版本使用flake8：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">举例1：python3.5 -m flake8</span><br><span class="line">举例2：python2.7 -m flake8</span><br></pre></td></tr></table></figure><p>使用flake8对一个项目做语法检查：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flake8 my_project/</span><br></pre></td></tr></table></figure><h3 id="选项与配置文件"><a href="#选项与配置文件" class="headerlink" title="选项与配置文件"></a>选项与配置文件</h3><p>关于flake8 –help的哪些options的解释：<a href="http://flake8.pycqa.org/en/latest/user/options.html" target="_blank" rel="noopener">http://flake8.pycqa.org/en/latest/user/options.html</a></p><p>flake8的options配置每次在使用的时候写到命令行有点麻烦，可以写到配置文件中，在一个project中支持的配置文件：<strong>setup.cfg, tox.ini, or .flake8</strong>.<br>并不是所有的命令行配置的options都可以写到配置文件里，<br>举个例子，命令行转换到配置文件中：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">flake8 --ignore D203 \</span><br><span class="line">         --exclude .git,__pycache__,docs/source/conf.py,old,build,dist \</span><br><span class="line">         --max-complexity 10</span><br></pre></td></tr></table></figure><p>配置文件：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[flake8]</span><br><span class="line">ignore = D203</span><br><span class="line">exclude = .git,__pycache__,docs/source/conf.py,old,build,dist</span><br><span class="line">max-complexity = 10</span><br></pre></td></tr></table></figure><p>规范一点的话：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[flake8]</span><br><span class="line">ignore = D203</span><br><span class="line">exclude =</span><br><span class="line">    .git,</span><br><span class="line">    __pycache__,</span><br><span class="line">    docs/source/conf.py,</span><br><span class="line">    old,</span><br><span class="line">    build,</span><br><span class="line">    dist</span><br><span class="line">max-complexity = 10</span><br></pre></td></tr></table></figure><p>如果你愿意，也可以加上注释，这样可读性更好：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[flake8]</span><br><span class="line">ignore = D203</span><br><span class="line">exclude =</span><br><span class="line">    # No need to traverse our git directory</span><br><span class="line">    .git,</span><br><span class="line">    # There&apos;s no value in checking cache directories</span><br><span class="line">    __pycache__,</span><br><span class="line">    # The conf file is mostly autogenerated, ignore it</span><br><span class="line">    docs/source/conf.py,</span><br><span class="line">    # The old directory contains Flake8 2.0</span><br><span class="line">    old,</span><br><span class="line">    # This contains our built documentation</span><br><span class="line">    build,</span><br><span class="line">    # This contains builds of flake8 that we don&apos;t want to check</span><br><span class="line">    dist</span><br><span class="line">max-complexity = 10</span><br></pre></td></tr></table></figure><p>当你有很多配置的时候注释呢，作用还是很大的，例如：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[flake8]</span><br><span class="line"># it&apos;s not a bug that we aren&apos;t using all of hacking, ignore:</span><br><span class="line"># F812: list comprehension redefines ...</span><br><span class="line"># H101: Use TODO(NAME)</span><br><span class="line"># H202: assertRaises Exception too broad</span><br><span class="line"># H233: Python 3.x incompatible use of print operator</span><br><span class="line"># H301: one import per line</span><br><span class="line"># H306: imports not in alphabetical order (time, os)</span><br><span class="line"># H401: docstring should not start with a space</span><br><span class="line"># H403: multi line docstrings should end on a new line</span><br><span class="line"># H404: multi line docstring should start without a leading new line</span><br><span class="line"># H405: multi line docstring summary not separated with an empty line</span><br><span class="line"># H501: Do not use self.__dict__ for string formatting</span><br><span class="line">ignore = F812,H101,H202,H233,H301,H306,H401,H403,H404,H405,H501</span><br></pre></td></tr></table></figure><h3 id="状态码"><a href="#状态码" class="headerlink" title="状态码"></a>状态码</h3><p>Flake8 基础错误返回码一共有三类：</p><ol><li>E<strong><em>/W</em></strong>：PEP8 中的 error 和 warning。</li><li>F***：通过 PyFlakes 检测出的 error，其实 PyFlakes 本身是不提供错误返回码的，flake8 对 pyflakes 返回的错误消息进行了分类。</li><li>C9**：通过 McCabe 检测出的代码复杂度。</li></ol><p>关于返回错误码的具体解释：<br>F开头的： <a href="http://flake8.pycqa.org/en/latest/user/error-codes.html" target="_blank" rel="noopener">http://flake8.pycqa.org/en/latest/user/error-codes.html</a><br>E和W开头的错：<a href="https://pycodestyle.readthedocs.io/en/latest/intro.html#error-codes" target="_blank" rel="noopener">https://pycodestyle.readthedocs.io/en/latest/intro.html#error-codes</a><br>C开头的，代码的复杂度是怎么计算的：<a href="https://en.wikipedia.org/wiki/Cyclomatic_complexity" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Cyclomatic_complexity</a><br>pyCodeStyle: <a href="http://pycodestyle.pycqa.org" target="_blank" rel="noopener">http://pycodestyle.pycqa.org</a></p><h3 id="插件"><a href="#插件" class="headerlink" title="插件"></a>插件</h3><p>flake8的插件查找：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip search flake8</span><br></pre></td></tr></table></figure><p>推荐使用的插件：<br>hacking<br>pep8-naming<br>flake8-chart</p><h2 id="hacking"><a href="#hacking" class="headerlink" title="hacking"></a>hacking</h2><p>link：</p><p><a href="https://pypi.python.org/pypi/hacking" target="_blank" rel="noopener">https://pypi.python.org/pypi/hacking</a><br><a href="https://docs.openstack.org/hacking/latest/user/index.html" target="_blank" rel="noopener">https://docs.openstack.org/hacking/latest/user/index.html</a></p><h3 id="简介-2"><a href="#简介-2" class="headerlink" title="简介"></a>简介</h3><p>hacking就是flake8的一个插件，主要用来把代码规范为openstack style 的格式</p><p>hacking最初是基于nova的第一个commit，基于google python style的，后来逐渐增加了openstack style的一些规则，hacking主要实现了规则如下：</p><ol><li>Agree on a common style guide so reviews don’t get bogged down on style nit picks. (example: docstring guidelines)</li><li>Make code written by many different authors easier to read by making the style more uniform. (example: unix vs windows newlines)</li><li>Call out dangerous patterns and avoid them. (example: shadowing built-in or reserved words)</li></ol><p>大致意思：</p><ol><li>统一一个共同的风格指南，所以评论不用再挑选书写的风格。 （例如：docstring指南）</li><li>通过使样式更加统一，使许多不同作者编写的代码更容易阅读。 （例如：unix vs windows newlines）</li><li>指出危险模式并避免它们。 （例如：遮蔽内置或保留字）<h3 id="安装-2"><a href="#安装-2" class="headerlink" title="安装"></a>安装</h3></li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install hacking</span><br></pre></td></tr></table></figure><p>hacking依赖于flake8,并且自己没有单独的命令，安装完后，执行flake8检查python脚本时，会有一堆H开头的错误，是hacking插件的；</p><h3 id="使用-1"><a href="#使用-1" class="headerlink" title="使用"></a>使用</h3><p>hacking的使用：</p><p><a href="https://docs.openstack.org/hacking/latest/user/usage.html" target="_blank" rel="noopener">https://docs.openstack.org/hacking/latest/user/usage.html</a></p><h3 id="什么是openstack-style"><a href="#什么是openstack-style" class="headerlink" title="什么是openstack style"></a>什么是openstack style</h3><p><a href="https://docs.openstack.org/hacking/latest/user/hacking.html" target="_blank" rel="noopener">openstack style guidelines</a></p><h2 id="yapf"><a href="#yapf" class="headerlink" title="yapf"></a>yapf</h2><p>link：</p><p><a href="https://github.com/google/yapf" target="_blank" rel="noopener">https://github.com/google/yapf</a></p><p><a href="https://pypi.org/project/yapf/" target="_blank" rel="noopener">https://pypi.org/project/yapf/</a></p><h3 id="简介-3"><a href="#简介-3" class="headerlink" title="简介"></a>简介</h3><p>yapf(Yet Another Python Formatter)是Google开源的一个用来格式化Python代码的工具. 支持2种代码规范(PEP8和Google style)</p><h3 id="安装-3"><a href="#安装-3" class="headerlink" title="安装"></a>安装</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install yapf</span><br></pre></td></tr></table></figure><h3 id="返回状态码"><a href="#返回状态码" class="headerlink" title="返回状态码"></a>返回状态码</h3><p>还有返回状态码呢，当执行成功时返回0，否则返回非0数值<br>使用–diff 选项，当没有文件无变化是返回0，否则返回非0<br>这个特性可以用CI(持续集成)</p><h3 id="yapfignore"><a href="#yapfignore" class="headerlink" title=".yapfignore"></a>.yapfignore</h3><p>类似于.gitignore</p><h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><p>可配置在命令行，使用–style(可选择pep8或google)，其他参数可使用{key:value}这种字典的格式写到命令行中<br>例如：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--style=&apos;&#123;based_on_style: chromium, indent_width: 4&#125;&apos;</span><br></pre></td></tr></table></figure><p>写到配置文件中举例：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[yapf]</span><br><span class="line">based_on_style = pep8</span><br><span class="line">spaces_before_comment = 4</span><br><span class="line">split_before_logical_operator = true</span><br></pre></td></tr></table></figure><h4 id="配置的优先级选择："><a href="#配置的优先级选择：" class="headerlink" title="配置的优先级选择："></a>配置的优先级选择：</h4><p>默认选择pep8</p><ol><li>Specified on the command line</li><li>In the [style] section of a .style.yapf file in either the current directory or one of its parent directories.</li><li>In the [yapf] section of a setup.cfg file in either the current directory or one of its parent directories.</li><li>In the ~/.config/yapf/style file in your home directory.</li></ol><h4 id="导出当前的配置文件"><a href="#导出当前的配置文件" class="headerlink" title="导出当前的配置文件"></a>导出当前的配置文件</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yapf --style-help &gt;yapf-style.config</span><br></pre></td></tr></table></figure><h3 id="简单使用举例"><a href="#简单使用举例" class="headerlink" title="简单使用举例"></a>简单使用举例</h3><p>原来的ugly code:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">x = &#123;  &apos;a&apos;:37,&apos;b&apos;:42,</span><br><span class="line"></span><br><span class="line">&apos;c&apos;:927&#125;</span><br><span class="line"></span><br><span class="line">y = &apos;hello &apos;&apos;world&apos;</span><br><span class="line">z = &apos;hello &apos;+&apos;world&apos;</span><br><span class="line">a = &apos;hello &#123;&#125;&apos;.format(&apos;world&apos;)</span><br><span class="line">class foo  (     object  ):</span><br><span class="line">  def f    (self   ):</span><br><span class="line">    return       37*-+2</span><br><span class="line">  def g(self, x,y=42):</span><br><span class="line">      return y</span><br><span class="line">def f  (   a ) :</span><br><span class="line">  return      37+-+a[42-x :  y**3]</span><br></pre></td></tr></table></figure><p>经过yapf格式化后：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">x = &#123;&apos;a&apos;: 37, &apos;b&apos;: 42, &apos;c&apos;: 927&#125;</span><br><span class="line"></span><br><span class="line">y = &apos;hello &apos; &apos;world&apos;</span><br><span class="line">z = &apos;hello &apos; + &apos;world&apos;</span><br><span class="line">a = &apos;hello &#123;&#125;&apos;.format(&apos;world&apos;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class foo(object):</span><br><span class="line">    def f(self):</span><br><span class="line">        return 37 * -+2</span><br><span class="line"></span><br><span class="line">    def g(self, x, y=42):</span><br><span class="line">        return y</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def f(a):</span><br><span class="line">    return 37 + -+a[42 - x:y**3]</span><br></pre></td></tr></table></figure><h3 id="作为模块调用举例"><a href="#作为模块调用举例" class="headerlink" title="作为模块调用举例"></a><a href="https://github.com/google/yapf#id9" target="_blank" rel="noopener">作为模块调用举例</a></h3><h3 id="yapf的可配置项-Knobs"><a href="#yapf的可配置项-Knobs" class="headerlink" title="yapf的可配置项(Knobs)"></a>yapf的可配置项(Knobs)</h3><p>翻译成开关也可以</p><p><a href="https://github.com/google/yapf#id10" target="_blank" rel="noopener">https://github.com/google/yapf#id10</a></p><h3 id="使用yapf过程中可能会遇到的问题"><a href="#使用yapf过程中可能会遇到的问题" class="headerlink" title="使用yapf过程中可能会遇到的问题?"></a>使用yapf过程中可能会遇到的问题?</h3><p>官方举了两个例子：</p><p><a href="https://github.com/google/yapf#id12" target="_blank" rel="noopener">Why does YAPF destroy my awesome formatting?</a></p><p><a href="https://github.com/google/yapf#id13" target="_blank" rel="noopener">Why Not Improve Existing Tools?</a></p><p><a href="https://github.com/google/yapf#id14" target="_blank" rel="noopener">Can I Use YAPF In My Program?</a></p><h3 id="阔怕的细节-gory-details-："><a href="#阔怕的细节-gory-details-：" class="headerlink" title="阔怕的细节(gory details)："></a>阔怕的细节(gory details)：</h3><p>看了一下看不懂，可怕，大致意思是用一个加权树算法来计算是否将一行分开，又是否合并两行，我把英文的贴到这，以后再看；</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">Algorithm Design</span><br><span class="line">The main data structure in YAPF is the UnwrappedLine object. It holds a list of FormatTokens,</span><br><span class="line"></span><br><span class="line">that we would want to place on a single line if there were no column limit. An exception being</span><br><span class="line"></span><br><span class="line">a comment in the middle of an expression statement will force the line to be formatted on more</span><br><span class="line"></span><br><span class="line">than one line. The formatter works on one UnwrappedLine object at a time.</span><br><span class="line"></span><br><span class="line">An UnwrappedLine typically won&apos;t affect the formatting of lines before or after it. There is a</span><br><span class="line"></span><br><span class="line">part of the algorithm that may join two or more UnwrappedLines into one line. For instance, an</span><br><span class="line"></span><br><span class="line">if-then statement with a short body can be placed on a single line:</span><br><span class="line"></span><br><span class="line">if a == 42: continue</span><br><span class="line"></span><br><span class="line">YAPF&apos;s formatting algorithm creates a weighted tree that acts as the solution space for the algorithm.</span><br><span class="line"></span><br><span class="line">Each node in the tree represents the result of a formatting decision --- i.e., whether to split</span><br><span class="line"></span><br><span class="line">or not to split before a token. Each formatting decision has a cost associated with it. Therefore,</span><br><span class="line"></span><br><span class="line">the cost is realized on the edge between two nodes. (In reality, the weighted tree doesn&apos;t have </span><br><span class="line"></span><br><span class="line">separate edge objects, so the cost resides on the nodes themselves.)</span><br><span class="line"></span><br><span class="line">For example, take the following Python code snippet. For the sake of this example, assume that</span><br><span class="line"></span><br><span class="line">line (1) violates the column limit restriction and needs to be reformatted.</span><br><span class="line"></span><br><span class="line">def xxxxxxxxxxx(aaaaaaaaaaaa, bbbbbbbbb, cccccccc, dddddddd, eeeeee):  # 1</span><br><span class="line">    pass                                                               # 2</span><br><span class="line"></span><br><span class="line">For line (1), the algorithm will build a tree where each node (a FormattingDecisionState object)</span><br><span class="line"></span><br><span class="line">is the state of the line at that token given the decision to split before the token or not.</span><br><span class="line"></span><br><span class="line">Note: the FormatDecisionState objects are copied by value so each node in the graph is unique </span><br><span class="line"></span><br><span class="line">and a change in one doesn&apos;t affect other nodes.</span><br><span class="line"></span><br><span class="line">Heuristics are used to determine the costs of splitting or not splitting. Because a node holds </span><br><span class="line"></span><br><span class="line">the state of the tree up to a token&apos;s insertion, it can easily determine if a splitting decision</span><br><span class="line"></span><br><span class="line">will violate one of the style requirements. For instance, the heuristic is able to apply an extra</span><br><span class="line"></span><br><span class="line">penalty to the edge when not splitting between the previous token and the one being added.</span><br><span class="line"></span><br><span class="line">There are some instances where we will never want to split the line, because doing so will always</span><br><span class="line"></span><br><span class="line">be detrimental (i.e., it will require a backslash-newline, which is very rarely desirable). </span><br><span class="line"></span><br><span class="line">For line (1), we will never want to split the first three tokens: def, xxxxxxxxxxx, and (. Nor will</span><br><span class="line"></span><br><span class="line">we want to split between the ) and the : at the end. These regions are said to be &quot;unbreakable.&quot;</span><br><span class="line"></span><br><span class="line">This is reflected in the tree by there not being a &quot;split&quot; decision (left hand branch) within </span><br><span class="line"></span><br><span class="line">the unbreakable region.</span><br><span class="line"></span><br><span class="line">Now that we have the tree, we determine what the &quot;best&quot; formatting is by finding the path through</span><br><span class="line"></span><br><span class="line">the tree with the lowest cost.</span><br><span class="line"></span><br><span class="line">And that&apos;s it!</span><br></pre></td></tr></table></figure><h2 id="autopep8"><a href="#autopep8" class="headerlink" title="autopep8"></a>autopep8</h2><p>link：</p><p><a href="https://pypi.org/project/autopep8/0.8/" target="_blank" rel="noopener">https://pypi.org/project/autopep8/0.8/</a></p><p><a href="https://github.com/hhatto/autopep8" target="_blank" rel="noopener">https://github.com/hhatto/autopep8</a></p><h3 id="简介-4"><a href="#简介-4" class="headerlink" title="简介"></a>简介</h3><p>Autopep8是一个将Python代码<strong>自动排版为PEP8风格的小工具</strong>。它使用pep8工具来决定代码中的哪部分需要被排版。Autopep8可以修复大部分pep8工具中报告的排版问题。</p><h3 id="安装-4"><a href="#安装-4" class="headerlink" title="安装"></a>安装</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install autopep8</span><br></pre></td></tr></table></figure><p>依赖于 <a href="https://github.com/PyCQA/pycodestyle" target="_blank" rel="noopener">pycodestyle</a></p><h3 id="autopep8可以修复哪些状态码"><a href="#autopep8可以修复哪些状态码" class="headerlink" title="autopep8可以修复哪些状态码"></a>autopep8可以修复哪些状态码</h3><p>(我管这些错误提示统称叫状态码)</p><h4 id="第一种情况"><a href="#第一种情况" class="headerlink" title="第一种情况"></a>第一种情况</h4><p>autopep8可以修复一些pycodestyle的一些错误提示，具体的可以修复的状态码列表如下：<br><img src="https://upload-images.jianshu.io/upload_images/7770956-379138054a9979d9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"><br><img src="https://upload-images.jianshu.io/upload_images/7770956-2c836aaddce3dfe5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"><br>pycodestyle的错误格式提示码：<br><a href="https://pycodestyle.readthedocs.io/en/latest/intro.html#error-codes" target="_blank" rel="noopener">https://pycodestyle.readthedocs.io/en/latest/intro.html#error-codes</a></p><h4 id="第二种情况"><a href="#第二种情况" class="headerlink" title="第二种情况"></a>第二种情况</h4><p>autopep8还可以修复一些不在pycodestyle格式范围内的错误：</p><ul><li>纠正弃用的以及非惯用的python代码（通过 lib2to3）。这会让python 2.6 以及 python 2.7 的代码更加与 python3 兼容。（如果 W690 是enable的，这一项修复会被触发）</li><li>标准化具有多种行结束符的文件。</li><li>在类申明和它的第一个方法申明中间加一个空行。（由 E309 enable）</li><li>在类文档和它的第一个方法申明中间加一个空行。（由 E301 enable）</li><li>移除方法申明和它的文档之间的空行。 （由 E303 enable ）</li></ul><h4 id="第三种情况"><a href="#第三种情况" class="headerlink" title="第三种情况"></a>第三种情况</h4><p>autopep8也会忽略一些pycodestyle检查出来的状态码：</p><p>E112( expected an indented block)/E113(unexpected indentation)<br>用于非注释的E112 / E113是破坏语法规则的不良缩进的报告。 这些不应该被修改。</p><p>E265 block comment should start with ‘# ‘<br>如果注释看起来像代码，则忽略注释哈希后的间距。 autopep8避免修改这些因为它们不是真正的注释。 如果您真的想摆脱pycodestyle警告，请考虑删除已注释掉的代码。 （这可以通过根除自动化。）<br>大致意思应该是说，E265报的错误是注释的一段代码，所以不把这段代码格式化；</p><h3 id="autopep8使用"><a href="#autopep8使用" class="headerlink" title="autopep8使用"></a>autopep8使用</h3><p>autopep8默认不修复E711/E712,因为怕我们自己重写了默认的<strong>eq</strong>方法,即把x == None 修改成 x is None<br>也不修改所有的W6警告（一些旧的书写格式告警）：<br><img src="https://upload-images.jianshu.io/upload_images/7770956-7615f92f05a28958.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p><p>–aggressive/-a选项可以提高代码修改错误码的等级，E712报的错误，就是在–aggressive等级是2 的时候修复（就是，x == True could be changed to either x or x is True, but autopep8 chooses the former）<br>–aggressive选项还会删除代码中的行末空格，要是想更加规范代码中的文档注释，可以使用 <a href="https://github.com/myint/docformatter" target="_blank" rel="noopener">docformatter</a></p><p>可是你知道吗，我在此有一问，aggressive一共有几个等级？这文档也没有说明，或许只能从代码里找答案了…..</p><h4 id="举例"><a href="#举例" class="headerlink" title="举例"></a>举例</h4><p>一段不规范的代码<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">import math, sys;</span><br><span class="line"></span><br><span class="line">def example1():</span><br><span class="line">    ####This is a long comment. This should be wrapped to fit within 72 characters.</span><br><span class="line">    some_tuple=(   1,2, 3,&apos;a&apos;  );</span><br><span class="line">    some_variable=&#123;&apos;long&apos;:&apos;Long code lines should be wrapped within 79 characters.&apos;,</span><br><span class="line">    &apos;other&apos;:[math.pi, 100,200,300,9876543210,&apos;This is a long string that goes on&apos;],</span><br><span class="line">    &apos;more&apos;:&#123;&apos;inner&apos;:&apos;This whole logical line should be wrapped.&apos;,some_tuple:[1,</span><br><span class="line">    20,300,40000,500000000,60000000000000000]&#125;&#125;</span><br><span class="line">    return (some_tuple, some_variable)</span><br><span class="line">def example2(): return &#123;&apos;has_key() is deprecated&apos;:True&#125;.has_key(&#123;&apos;f&apos;:2&#125;.has_key(&apos;&apos;));</span><br><span class="line">class Example3(   object ):</span><br><span class="line">    def __init__    ( self, bar ):</span><br><span class="line">     #Comments should have a space after the hash.</span><br><span class="line">     if bar : bar+=1;  bar=bar* bar   ; return bar</span><br><span class="line">     else:</span><br><span class="line">                    some_string = &quot;&quot;&quot;</span><br><span class="line">                       Indentation in multiline strings should not be touched.</span><br><span class="line">Only actual code should be reindented.</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">                    return (sys.path, some_string)</span><br></pre></td></tr></table></figure><p></p><p>autopep8格式化命令：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">autopep8 --in-place --aggressive --aggressive &lt;filename&gt;</span><br><span class="line">简写：</span><br><span class="line">autopep8 -i -a -a &lt;filename&gt;</span><br></pre></td></tr></table></figure><p>经过autopep8格式化后：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">import math</span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def example1():</span><br><span class="line">    # This is a long comment. This should be wrapped to fit within 72</span><br><span class="line">    # characters.</span><br><span class="line">    some_tuple = (1, 2, 3, &apos;a&apos;)</span><br><span class="line">    some_variable = &#123;</span><br><span class="line">        &apos;long&apos;: &apos;Long code lines should be wrapped within 79 characters.&apos;,</span><br><span class="line">        &apos;other&apos;: [</span><br><span class="line">            math.pi,</span><br><span class="line">            100,</span><br><span class="line">            200,</span><br><span class="line">            300,</span><br><span class="line">            9876543210,</span><br><span class="line">            &apos;This is a long string that goes on&apos;],</span><br><span class="line">        &apos;more&apos;: &#123;</span><br><span class="line">            &apos;inner&apos;: &apos;This whole logical line should be wrapped.&apos;,</span><br><span class="line">            some_tuple: [</span><br><span class="line">                1,</span><br><span class="line">                20,</span><br><span class="line">                300,</span><br><span class="line">                40000,</span><br><span class="line">                500000000,</span><br><span class="line">                60000000000000000]&#125;&#125;</span><br><span class="line">    return (some_tuple, some_variable)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def example2(): return (&apos;&apos; in &#123;&apos;f&apos;: 2&#125;) in &#123;&apos;has_key() is deprecated&apos;: True&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class Example3(object):</span><br><span class="line">    def __init__(self, bar):</span><br><span class="line">        # Comments should have a space after the hash.</span><br><span class="line">        if bar:</span><br><span class="line">            bar += 1</span><br><span class="line">            bar = bar * bar</span><br><span class="line">            return bar</span><br><span class="line">        else:</span><br><span class="line">            some_string = &quot;&quot;&quot;</span><br><span class="line">                       Indentation in multiline strings should not be touched.</span><br><span class="line">Only actual code should be reindented.</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">            return (sys.path, some_string)</span><br></pre></td></tr></table></figure><p>其他常见命令行<br>指定autopep8只修改指定的状态码：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">autopep8 --select=E1,W1 &lt;filename&gt;</span><br></pre></td></tr></table></figure><p>只修改已被弃用的代码功能（W6）</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">autopep8 --aggressive --select=W6 &lt;filename&gt;</span><br></pre></td></tr></table></figure><p>想要看详细的修改过程，可以使用选项-v：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">autopep8 -v &lt;filename&gt;</span><br></pre></td></tr></table></figure><h3 id="autopep8配置文件"><a href="#autopep8配置文件" class="headerlink" title="autopep8配置文件"></a>autopep8配置文件</h3><p>如果想把autopep8的选项放到配置文件中，把指定的选项修改到配置文件<br>autopep8默认识别的配置文件：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">linux：$HOME/.config/.pycodestyle</span><br><span class="line">windows：~\.pycodestyle</span><br></pre></td></tr></table></figure><p>与其他的配置也兼容的文件：<br>setup.cfg, tox.ini, .pep8 and .flake8</p><p>在pep8, pycodestyle, flake8中配置格式举例：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[pycodestyle]</span><br><span class="line">max_line_length = 120</span><br><span class="line">ignore = E501</span><br></pre></td></tr></table></figure><h3 id="使用autopep8自动化测试"><a href="#使用autopep8自动化测试" class="headerlink" title="使用autopep8自动化测试"></a>使用autopep8自动化测试</h3><p>可以写到项目的test/test_autopep8.py中，直接使用python test/test_autopep8.py来测试，也可以使用tox来测试，使用tox测试适用于测试是否适用多个python版本非常有用；</p><p>可以通过test / acid.py获得广谱测试。 此脚本针对Python代码运行autopep8，并检查代码修复的正确性和完整性。 它可以检查字节码是否保持相同。 test / acid_pypi.py使用acid.py来测试PyPI上最新发布的软件包。</p><blockquote><p>什么是noqa：</p></blockquote><blockquote><p>no quality assurance（没有质量保证）</p></blockquote><blockquote><p>Adding # noqa to a line indicates that the linter (a program that automatically checks code quality) should not check this line. Any warnings that code may have generated will be ignored.</p></blockquote><h2 id="coverage"><a href="#coverage" class="headerlink" title="coverage"></a>coverage</h2><p>link:</p><p><a href="https://coverage.readthedocs.io/en/v4.5.x/" target="_blank" rel="noopener">https://coverage.readthedocs.io/en/v4.5.x/</a></p><p><a href="https://pypi.org/project/coverage/" target="_blank" rel="noopener">https://pypi.org/project/coverage/</a></p><h3 id="安装-5"><a href="#安装-5" class="headerlink" title="安装"></a>安装</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install coverage</span><br></pre></td></tr></table></figure><h3 id="命令行"><a href="#命令行" class="headerlink" title="命令行"></a>命令行</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">run – Run a Python program and collect execution data.</span><br><span class="line">report – Report coverage results.</span><br><span class="line">html – Produce annotated HTML listings with coverage results.</span><br><span class="line">xml – Produce an XML report with coverage results.</span><br><span class="line">annotate – Annotate source files with coverage results.</span><br><span class="line">erase – Erase previously collected coverage data.</span><br><span class="line">combine – Combine together a number of data files.</span><br><span class="line">debug – Get diagnostic information.</span><br></pre></td></tr></table></figure><p>基本上就是跑一下覆盖率的测试然后把结果保存到html，xml等等</p><p>配置文件内容及格式：<a href="https://coverage.readthedocs.io/en/v4.5.x/config.html#config" target="_blank" rel="noopener">https://coverage.readthedocs.io/en/v4.5.x/config.html#config</a></p><h3 id="coverage-run"><a href="#coverage-run" class="headerlink" title="coverage run"></a>coverage run</h3><p>arg1与arg2是手动传入的参数<br>默认不指定任何参数时，是当前文件夹下所有的代码；<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ coverage run my_program.py arg1 arg2</span><br><span class="line">blah blah ..your program&apos;s output.. blah blah</span><br></pre></td></tr></table></figure><p></p><h4 id="使用过程中可能用到的选项"><a href="#使用过程中可能用到的选项" class="headerlink" title="使用过程中可能用到的选项"></a>使用过程中可能用到的选项</h4><ol><li>使用-m选项也可以从模块导入要测试的函数或者类</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ coverage run -m packagename.modulename arg1 arg2</span><br><span class="line">blah blah ..your program&apos;s output.. blah blah</span><br></pre></td></tr></table></figure><ol start="2"><li>使用–source &lt;packages name/directories&gt;<blockquote><p>(&lt;packages name/directories&gt;使用逗号或换行符分隔)<br>使用source选项还可以使coverage.py报告未执行的文件，因为它可以在选项指定的包或目录中搜索尚未测试到的文件。这里所说的文件是指带有<strong>init</strong>.py可导入的模块</p></blockquote></li><li>–include<patterns><br>指定匹配的文件，patterns在此可使用正则,使用举例：/usr/*<br>如果source和include选项同时配置了，那么生效的是source选项；<br>也可以用在导出xml和html报告的输出命令中</patterns></li><li>–omit<patterns><br>指定要忽略的文件,patterns使用同上<br>也可以用在导出xml和html报告的输出命令中</patterns></li><li>–branch选项 <a href="https://coverage.readthedocs.io/en/v4.5.x/branch.html#branch" target="_blank" rel="noopener">https://coverage.readthedocs.io/en/v4.5.x/branch.html#branch</a></li><li>–concurrency<mode><br>multiprocessing, thread, greenlet, eventlet, or gevent<br>multiprocessing 不支持放在命令行</mode></li><li>–pylib<br>测试默认安装的包或模块</li><li>–rcfile=FILE<br>指定配置文件，在配置文件中可配置的项比命令行选项更丰富</li></ol><h3 id="coverage-warnnings"><a href="#coverage-warnnings" class="headerlink" title="coverage warnnings"></a>coverage warnnings</h3><p>During execution, coverage.py may warn you about conditions it detects that could affect the measurement process. The possible warnings include:</p><p><strong>“Trace function changed, measurement is likely wrong: XXX (trace-changed)”</strong></p><p>Coverage measurement depends on a Python setting called the trace function. Other Python code in your product</p><p>might change that function, which will disrupt coverage.py’s measurement. This warning indicates that has happened.</p><p>The XXX in the message is the new trace function value, which might provide a clue to the cause.</p><p><strong>“Module XXX has no Python source (module-not-python)”</strong></p><p>You asked coverage.py to measure module XXX, but once it was imported, it turned out not to have a corresponding .py file. Without a .py file,</p><p>coverage.py can’t report on missing lines.</p><p><strong>“Module XXX was never imported (module-not-imported)”</strong></p><p>You asked coverage.py to measure module XXX, but it was never imported by your program.</p><p><strong>“No data was collected (no-data-collected)”</strong></p><p>Coverage.py ran your program, but didn’t measure any lines as executed. This could be because you asked to measure only modules that never ran, or for other reasons.</p><p><strong>“Module XXX was previously imported, but not measured (module-not-measured)”</strong></p><p>You asked coverage.py to measure module XXX, but it had already been imported when coverage started. This meant coverage.py couldn’t monitor its execution.</p><p><strong>“–include is ignored because –source is set (include-ignored)”</strong></p><p>Both –include and –source were specified while running code. Both are meant to focus measurement on a particular part of your source code, so –include is ignored in favor of –source.</p><h4 id="配置这个warnning不可见"><a href="#配置这个warnning不可见" class="headerlink" title="配置这个warnning不可见"></a>配置这个warnning不可见</h4><p>Individual warnings can be disabled with the disable_warnings configuration setting. To silence “No data was collected,” add this to your .coveragerc file:</p><p>[run]<br>disable_warnings = no-data-collected</p><p>输出结果：<br>默认是存放在.coverage文件中，可通过环境变量COVERAGE_FILE指定<br>如果想要保存多次结果可使用-a选项，将执行结果追加在上次执行结果的后面；</p><h3 id="coverage-erase-清除结果"><a href="#coverage-erase-清除结果" class="headerlink" title="coverage erase 清除结果"></a>coverage erase 清除结果</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ coverage erase</span><br></pre></td></tr></table></figure><h3 id="coverage-combine-合并当前目录下的coverage结果"><a href="#coverage-combine-合并当前目录下的coverage结果" class="headerlink" title="coverage combine 合并当前目录下的coverage结果"></a>coverage combine 合并当前目录下的coverage结果</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">coverage combine</span><br></pre></td></tr></table></figure><p>合并指定名称，指定位置的结果</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ coverage combine data1.dat windows_data_files/</span><br></pre></td></tr></table></figure><p>如果不指定名称，将合并.coverage 和.coverage.xxx这种以.coverage为前缀的文件，举例：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.coverage.machine1</span><br><span class="line">.coverage.20120807T212300</span><br><span class="line">.coverage.last_good_run.ok</span><br></pre></td></tr></table></figure><p>更详细的功能参考：<a href="https://coverage.readthedocs.io/en/v4.5.x/cmd.html" target="_blank" rel="noopener">https://coverage.readthedocs.io/en/v4.5.x/cmd.html</a></p><h3 id="converage-report-输出报告"><a href="#converage-report-输出报告" class="headerlink" title="converage report 输出报告"></a>converage report 输出报告</h3><p>在输出报告时可能用到的选项：</p><p>–include/–omit 参考上文</p><p>-i/-ignore-errors</p><p>The -i or –ignore-errors switch tells coverage.py to ignore problems encountered trying to find source files to report on.</p><p>This can be useful if some files are missing, or if your Python execution is tricky enough that file names are synthesized without real source files.</p><p>–fail-under</p><p>If you provide a –fail-under value, the total percentage covered will be compared to that value. If it is less,</p><p>the command will exit with a status code of 2, indicating that the total coverage was less than your target.</p><p>This can be used as part of a pass/fail condition, for example in a continuous integration server. This option isn’t available for annotate.</p><p>-m shows the line numbers of missing statements, If you are using branch coverage, then branch statistics will be</p><p>reported in the Branch and BrPart (for Partial Branch) columns, the Missing column will detail the missed branches</p><p>–skip-covered<br>The –skip-covered switch will leave out any file with 100% coverage, letting you focus on the files that still need attention.</p><p>输出报告的命令：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ coverage report</span><br><span class="line">Name                      Stmts   Miss  Cover</span><br><span class="line">---------------------------------------------</span><br><span class="line">my_program.py                20      4    80%</span><br><span class="line">my_module.py                 15      2    86%</span><br><span class="line">my_other_module.py           56      6    89%</span><br><span class="line">---------------------------------------------</span><br><span class="line">TOTAL                        91     12    87%</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ coverage report -m</span><br><span class="line">Name                      Stmts   Miss Branch BrPart  Cover   Missing</span><br><span class="line">---------------------------------------------------------------------</span><br><span class="line">my_program.py                20      4     10      2    80%   33-35, 36-&gt;38, 39</span><br><span class="line">my_module.py                 15      2      3      0    86%   8, 12</span><br><span class="line">my_other_module.py           56      6      5      1    89%   17-23, 40-&gt;45</span><br><span class="line">---------------------------------------------------------------------</span><br><span class="line">TOTAL                        91     12     18      3    87%</span><br></pre></td></tr></table></figure><h3 id="HTML-annotaion"><a href="#HTML-annotaion" class="headerlink" title="HTML annotaion"></a><a href="https://coverage.readthedocs.io/en/v4.5.x/cmd.html#html-annotation" target="_blank" rel="noopener">HTML annotaion</a></h3><p><a href="https://nedbatchelder.com/files/sample_coverage_html/index.html" target="_blank" rel="noopener">html报告样例</a></p><p>生成命令：</p><p>The -d argument specifies an output directory, defaulting to “htmlcov”:<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ coverage html -d coverage_html</span><br></pre></td></tr></table></figure><p></p><h3 id="Text-annotaion"><a href="#Text-annotaion" class="headerlink" title="Text annotaion"></a><a href="https://coverage.readthedocs.io/en/v4.5.x/cmd.html#text-annotation" target="_blank" rel="noopener">Text annotaion</a></h3><h3 id="XML-reporting"><a href="#XML-reporting" class="headerlink" title="XML reporting"></a><a href="https://coverage.readthedocs.io/en/v4.5.x/cmd.html#xml-reporting" target="_blank" rel="noopener">XML reporting</a></h3><p>The xml command writes coverage data to a “coverage.xml” file in a format compatible with <a href="http://cobertura.github.io/cobertura/" target="_blank" rel="noopener">Cobertura</a>.</p><p>You can specify the name of the output file with the -o switch.</p><h3 id="debug"><a href="#debug" class="headerlink" title="debug"></a><a href="https://coverage.readthedocs.io/en/v4.5.x/cmd.html#diagnostics" target="_blank" rel="noopener">debug</a></h3><p>The debug command shows internal information to help diagnose problems. If you are reporting a bug about coverage.py, including the output of this command can often help:</p><p>命令行使用：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ coverage debug sys &gt; please_attach_to_bug_report.txt</span><br></pre></td></tr></table></figure><p>Three types of information are available:</p><p>config: show coverage’s configuration<br>sys: show system configuration,<br>data: show a summary of the collected coverage data</p><h2 id="文章参考"><a href="#文章参考" class="headerlink" title="文章参考"></a>文章参考</h2><p><a href="https://linux.cn/article-10059-1.html" target="_blank" rel="noopener">https://linux.cn/article-10059-1.html</a></p><p><a href="https://www.jianshu.com/p/e485c82dcff9" target="_blank" rel="noopener">https://www.jianshu.com/p/e485c82dcff9</a></p></div><footer class="post-footer"><div class="post-tags"><a href="/tags/pep8/" rel="tag"># pep8</a> <a href="/tags/python/" rel="tag"># python</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/archives/5124f222.html" rel="next" title="排序算法整理"><i class="fa fa-chevron-left"></i> 排序算法整理</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"><a href="/archives/7f473fb4.html" rel="prev" title="All This I Did Without You">All This I Did Without You <i class="fa fa-chevron-right"></i></a></div></div></footer></div></article><div class="post-spread"></div></div></div><div class="comments" id="comments"><div onclick="showGitment()" id="gitment-display-button">显示 Gitment 评论</div><div id="gitment-container" style="display:none"></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div id="sidebar-dimmer"></div><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap">站点概览</li></ul><section class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><p class="site-author-name" itemprop="name">haoxiaoci</p><p class="site-description motion-element" itemprop="description"></p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">5</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/index.html"><span class="site-state-item-count">5</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/haoxiaoci" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i>GitHub</a></span></div></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#pep8"><span class="nav-number">1.</span> <span class="nav-text">pep8</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#pycodestyle"><span class="nav-number">2.</span> <span class="nav-text">pycodestyle</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#简介"><span class="nav-number">2.1.</span> <span class="nav-text">简介</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#特点"><span class="nav-number">2.2.</span> <span class="nav-text">特点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#安装"><span class="nav-number">2.3.</span> <span class="nav-text">安装</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用"><span class="nav-number">2.4.</span> <span class="nav-text">使用</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#flake8"><span class="nav-number">3.</span> <span class="nav-text">flake8</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#简介-1"><span class="nav-number">3.1.</span> <span class="nav-text">简介</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#安装-1"><span class="nav-number">3.2.</span> <span class="nav-text">安装</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#基本使用"><span class="nav-number">3.3.</span> <span class="nav-text">基本使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#选项与配置文件"><span class="nav-number">3.4.</span> <span class="nav-text">选项与配置文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#状态码"><span class="nav-number">3.5.</span> <span class="nav-text">状态码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#插件"><span class="nav-number">3.6.</span> <span class="nav-text">插件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#hacking"><span class="nav-number">4.</span> <span class="nav-text">hacking</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#简介-2"><span class="nav-number">4.1.</span> <span class="nav-text">简介</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#安装-2"><span class="nav-number">4.2.</span> <span class="nav-text">安装</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用-1"><span class="nav-number">4.3.</span> <span class="nav-text">使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#什么是openstack-style"><span class="nav-number">4.4.</span> <span class="nav-text">什么是openstack style</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#yapf"><span class="nav-number">5.</span> <span class="nav-text">yapf</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#简介-3"><span class="nav-number">5.1.</span> <span class="nav-text">简介</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#安装-3"><span class="nav-number">5.2.</span> <span class="nav-text">安装</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#返回状态码"><span class="nav-number">5.3.</span> <span class="nav-text">返回状态码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#yapfignore"><span class="nav-number">5.4.</span> <span class="nav-text">.yapfignore</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#配置"><span class="nav-number">5.5.</span> <span class="nav-text">配置</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#配置的优先级选择："><span class="nav-number">5.5.1.</span> <span class="nav-text">配置的优先级选择：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#导出当前的配置文件"><span class="nav-number">5.5.2.</span> <span class="nav-text">导出当前的配置文件</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#简单使用举例"><span class="nav-number">5.6.</span> <span class="nav-text">简单使用举例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#作为模块调用举例"><span class="nav-number">5.7.</span> <span class="nav-text">作为模块调用举例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#yapf的可配置项-Knobs"><span class="nav-number">5.8.</span> <span class="nav-text">yapf的可配置项(Knobs)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用yapf过程中可能会遇到的问题"><span class="nav-number">5.9.</span> <span class="nav-text">使用yapf过程中可能会遇到的问题?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#阔怕的细节-gory-details-："><span class="nav-number">5.10.</span> <span class="nav-text">阔怕的细节(gory details)：</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#autopep8"><span class="nav-number">6.</span> <span class="nav-text">autopep8</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#简介-4"><span class="nav-number">6.1.</span> <span class="nav-text">简介</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#安装-4"><span class="nav-number">6.2.</span> <span class="nav-text">安装</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#autopep8可以修复哪些状态码"><span class="nav-number">6.3.</span> <span class="nav-text">autopep8可以修复哪些状态码</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#第一种情况"><span class="nav-number">6.3.1.</span> <span class="nav-text">第一种情况</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#第二种情况"><span class="nav-number">6.3.2.</span> <span class="nav-text">第二种情况</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#第三种情况"><span class="nav-number">6.3.3.</span> <span class="nav-text">第三种情况</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#autopep8使用"><span class="nav-number">6.4.</span> <span class="nav-text">autopep8使用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#举例"><span class="nav-number">6.4.1.</span> <span class="nav-text">举例</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#autopep8配置文件"><span class="nav-number">6.5.</span> <span class="nav-text">autopep8配置文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用autopep8自动化测试"><span class="nav-number">6.6.</span> <span class="nav-text">使用autopep8自动化测试</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#coverage"><span class="nav-number">7.</span> <span class="nav-text">coverage</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#安装-5"><span class="nav-number">7.1.</span> <span class="nav-text">安装</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#命令行"><span class="nav-number">7.2.</span> <span class="nav-text">命令行</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#coverage-run"><span class="nav-number">7.3.</span> <span class="nav-text">coverage run</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#使用过程中可能用到的选项"><span class="nav-number">7.3.1.</span> <span class="nav-text">使用过程中可能用到的选项</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#coverage-warnnings"><span class="nav-number">7.4.</span> <span class="nav-text">coverage warnnings</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#配置这个warnning不可见"><span class="nav-number">7.4.1.</span> <span class="nav-text">配置这个warnning不可见</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#coverage-erase-清除结果"><span class="nav-number">7.5.</span> <span class="nav-text">coverage erase 清除结果</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#coverage-combine-合并当前目录下的coverage结果"><span class="nav-number">7.6.</span> <span class="nav-text">coverage combine 合并当前目录下的coverage结果</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#converage-report-输出报告"><span class="nav-number">7.7.</span> <span class="nav-text">converage report 输出报告</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HTML-annotaion"><span class="nav-number">7.8.</span> <span class="nav-text">HTML annotaion</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Text-annotaion"><span class="nav-number">7.9.</span> <span class="nav-text">Text annotaion</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#XML-reporting"><span class="nav-number">7.10.</span> <span class="nav-text">XML reporting</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#debug"><span class="nav-number">7.11.</span> <span class="nav-text">debug</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#文章参考"><span class="nav-number">8.</span> <span class="nav-text">文章参考</span></a></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; 2018 &mdash; <span itemprop="copyrightYear">2020</span> <span class="with-love"><i class="fa fa-haoxiaoci"></i> </span><span class="author" itemprop="copyrightHolder">haoxiaoci</span></div><div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div><span class="post-meta-divider">|</span><div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script><script type="text/javascript">function proceedsearch(){$("body").append('<div class="search-popup-overlay local-search-pop-overlay"></div>').css("overflow","hidden"),$(".search-popup-overlay").click(onPopupClose),$(".popup").toggle();var t=$("#local-search-input");t.attr("autocapitalize","none"),t.attr("autocorrect","off"),t.focus()}var isfetched=!1,isXml=!0,search_path="search.xml";0===search_path.length?search_path="search.xml":/json$/i.test(search_path)&&(isXml=!1);var path="/"+search_path,onPopupClose=function(t){$(".popup").hide(),$("#local-search-input").val(""),$(".search-result-list").remove(),$("#no-result").remove(),$(".local-search-pop-overlay").remove(),$("body").css("overflow","")},searchFunc=function(t,e,o){"use strict";$("body").append('<div class="search-popup-overlay local-search-pop-overlay"><div id="search-loading-icon"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div>').css("overflow","hidden"),$("#search-loading-icon").css("margin","20% auto 0 auto").css("text-align","center"),$.ajax({url:t,dataType:isXml?"xml":"json",async:!0,success:function(t){isfetched=!0,$(".popup").detach().appendTo(".header-inner");var n=isXml?$("entry",t).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get():t,r=document.getElementById(e),s=document.getElementById(o),a=function(){var t=r.value.trim().toLowerCase(),e=t.split(/[\s\-]+/);e.length>1&&e.push(t);var o=[];if(t.length>0&&n.forEach(function(n){function r(e,o,n,r){for(var s=r[r.length-1],a=s.position,i=s.word,l=[],h=0;a+i.length<=n&&0!=r.length;){i===t&&h++,l.push({position:a,length:i.length});var p=a+i.length;for(r.pop();0!=r.length&&(s=r[r.length-1],a=s.position,i=s.word,p>a);)r.pop()}return c+=h,{hits:l,start:o,end:n,searchTextCount:h}}function s(t,e){var o="",n=e.start;return e.hits.forEach(function(e){o+=t.substring(n,e.position);var r=e.position+e.length;o+='<b class="search-keyword">'+t.substring(e.position,r)+"</b>",n=r}),o+=t.substring(n,e.end)}var a=!1,i=0,c=0,l=n.title.trim(),h=l.toLowerCase(),p=n.content.trim().replace(/<[^>]+>/g,""),u=p.toLowerCase(),f=decodeURIComponent(n.url),d=[],g=[];if(""!=l&&(e.forEach(function(t){function e(t,e,o){var n=t.length;if(0===n)return[];var r=0,s=[],a=[];for(o||(e=e.toLowerCase(),t=t.toLowerCase());(s=e.indexOf(t,r))>-1;)a.push({position:s,word:t}),r=s+n;return a}d=d.concat(e(t,h,!1)),g=g.concat(e(t,u,!1))}),(d.length>0||g.length>0)&&(a=!0,i=d.length+g.length)),a){[d,g].forEach(function(t){t.sort(function(t,e){return e.position!==t.position?e.position-t.position:t.word.length-e.word.length})});var v=[];0!=d.length&&v.push(r(l,0,l.length,d));for(var $=[];0!=g.length;){var C=g[g.length-1],m=C.position,x=C.word,w=m-20,y=m+80;0>w&&(w=0),y<m+x.length&&(y=m+x.length),y>p.length&&(y=p.length),$.push(r(p,w,y,g))}$.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hits.length!==e.hits.length?e.hits.length-t.hits.length:t.start-e.start});var T=parseInt("1");T>=0&&($=$.slice(0,T));var b="";b+=0!=v.length?"<li><a href='"+f+"' class='search-result-title'>"+s(l,v[0])+"</a>":"<li><a href='"+f+"' class='search-result-title'>"+l+"</a>",$.forEach(function(t){b+="<a href='"+f+'\'><p class="search-result">'+s(p,t)+"...</p></a>"}),b+="</li>",o.push({item:b,searchTextCount:c,hitCount:i,id:o.length})}}),1===e.length&&""===e[0])s.innerHTML='<div id="no-result"><i class="fa fa-search fa-5x" /></div>';else if(0===o.length)s.innerHTML='<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>';else{o.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hitCount!==e.hitCount?e.hitCount-t.hitCount:e.id-t.id});var a='<ul class="search-result-list">';o.forEach(function(t){a+=t.item}),a+="</ul>",s.innerHTML=a}};r.addEventListener("input",a),$(".local-search-pop-overlay").remove(),$("body").css("overflow",""),proceedsearch()}})};$(".popup-trigger").click(function(t){t.stopPropagation(),isfetched===!1?searchFunc(path,"local-search-input","local-search-result"):proceedsearch()}),$(".popup-btn-close").click(onPopupClose),$(".popup").click(function(t){t.stopPropagation()}),$(document).on("keyup",function(t){var e=27===t.which&&$(".search-popup").is(":visible");e&&onPopupClose()})</script><script type="text/javascript" src="/js/src/js.cookie.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/scroll-cookie.js?v=5.1.4"></script><script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",model:{jsonPath:"/live2dw/assets/z16.model.json"},display:{position:"right",width:100,height:200},mobile:{show:!1},log:!1,tagMode:!1})</script></body></html><!-- rebuild by neat -->